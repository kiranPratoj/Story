This is chapter3. edited under version1
this is after the branching in chapter 3