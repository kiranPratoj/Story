This is chapter3. edited under version1